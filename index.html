<!DOCTYPE html>
<html lang="en">
<head>

        <title>Tech Notes</title>
        <meta charset="utf-8" />
        <link href="http://xiaojianfeng.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Tech Notes Full Atom Feed" />


        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" type="text/css" href="http://xiaojianfeng.github.io/theme/gumby.css" />
        <link rel="stylesheet" type="text/css" href="http://xiaojianfeng.github.io/theme/style.css" />
        <link rel="stylesheet" type="text/css" href="http://xiaojianfeng.github.io/theme/pygment.css" />

        <script src="http://xiaojianfeng.github.io/theme/js/libs/modernizr-2.6.2.min.js"></script>




</head>

<body id="index" class="home">


    <div class="container">

        <div class="row">

          <header id="banner" class="body">
                  <h1><a href="http://xiaojianfeng.github.io/">Tech Notes <strong></strong></a></h1>
          </header><!-- /#banner -->

            <div id="navigation" class="navbar row">
              <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>
             
              <ul class="columns">
                <li><a href="http://xiaojianfeng.github.io/">Home</a></li>


              </ul>
            </div>

<section id="content">



   <div class="row">


        <div class="eleven columns">
                 <ol id="post-list">
                        <li><article class="hentry">
                                <header> <h2 class="entry-title"><a href="http://xiaojianfeng.github.io/general/finally-i-moved-to-mac.html" rel="bookmark" title="Permalink to finally I moved to Mac">finally I moved to Mac</a></h2> </header>
                                <footer class="post-info">
                                    <abbr class="published" title="2015-01-20T16:09:27+08:00"> Tue 20 January 2015 </abbr>
                                    <address class="vcard author">By 
                                    <a class="url fn" href="http://xiaojianfeng.github.io/author/xiao-jianfeng.html"> Xiao Jianfeng</a>
                                    </address>
                                </footer><!-- /.post-info -->
                                <div class="entry-content"> <p>2014年年底，用了七年多的在最后一年从Windows转向Linux的T61因为nvidia显卡门报废，决定换成Mac了。</p>
<p>理由很简单，我用电脑主要用来办公和编程。Windows因为有MS Office，办公不错，但是编程(包括数据处理)方面太差；Linux在编程方面很好，但是办公方面就是渣:只有Mac可以兼顾二者。</p> </div><!-- /.entry-content -->

                                <div class="medium primary btn"><a href="http://xiaojianfeng.github.io/general/finally-i-moved-to-mac.html" rel="bookmark" title="Permalink to finally I moved to Mac">Read more <i class="icon-arrow-right"></i></a></div>



                                <div class="row tag-row">
                                </div>



                        </article></li>
                        <li><article class="hentry">
                                <header> <h2 class="entry-title"><a href="http://xiaojianfeng.github.io/code/create-shortcurt-key-for-ksnapshot.html" rel="bookmark" title="Permalink to create shortcurt key for ksnapshot">create shortcurt key for ksnapshot</a></h2> </header>
                                <footer class="post-info">
                                    <abbr class="published" title="2014-08-14T23:27:51+08:00"> Thu 14 August 2014 </abbr>
                                    <address class="vcard author">By 
                                    <a class="url fn" href="http://xiaojianfeng.github.io/author/xiao-jianfeng.html"> Xiao Jianfeng</a>
                                    </address>
                                </footer><!-- /.post-info -->
                                <div class="entry-content"> <p>ksnapshot is a powerful tool to take snapshot. However, each time you have to start ksnapshot from the application menu, which is not as efficient as it should be.</p>
<p>Here is how to create shortcut key for ksnapshot.</p>
<ul>
<li>
<p>go to "System Settings" --&gt; "Shortcuts and Gestures" --&gt; "Custom Shortcuts"
   --&gt; "Preset Actions" --&gt; "PrintScreen"</p>
<p>set "Meta + S" (Win + S), which is the same as screen clipping shortcut for onenote on Windows, for Trigger;
   <img alt="set shotcut key" src="/images/ksnapshot1.png" /></p>
<p>and set "ksnapshot --region" as "Command/URL" for Action. Here I prefer the default behavior to take screenshot of rectangel area. You can just use "ksnapshot" if you like.
   <img alt="set command" src="/images/ksnapshot2.png" /></p>
</li>
</ul>
<p>That's all. Now you can just press "Win + S" and select a rectangle region to take a screenshot.</p> </div><!-- /.entry-content -->

                                <div class="medium primary btn"><a href="http://xiaojianfeng.github.io/code/create-shortcurt-key-for-ksnapshot.html" rel="bookmark" title="Permalink to create shortcurt key for ksnapshot">Read more <i class="icon-arrow-right"></i></a></div>



                                <div class="row tag-row">
                                </div>



                        </article></li>
                        <li><article class="hentry">
                                <header> <h2 class="entry-title"><a href="http://xiaojianfeng.github.io/code/install-chinese-input-method-on-t61-running-debian.html" rel="bookmark" title="Permalink to install Chinese input method on T61 running Debian">install Chinese input method on T61 running Debian</a></h2> </header>
                                <footer class="post-info">
                                    <abbr class="published" title="2014-08-13T22:39:27+08:00"> Wed 13 August 2014 </abbr>
                                    <address class="vcard author">By 
                                    <a class="url fn" href="http://xiaojianfeng.github.io/author/xiao-jianfeng.html"> Xiao Jianfeng</a>
                                    </address>
                                </footer><!-- /.post-info -->
                                <div class="entry-content"> <p>Now it is much eaiser to install Chinese input method than before.</p>
<ol>
<li>
<p>apt-get install task-chinese-s-kde-desktop fcitx-pinyin</p>
</li>
<li>
<p>Go to "Settings" --&gt; "System Settings" --&gt; "Local" --&gt; "Input Method" --&gt; "Input Method"
   --&gt; add "Pinyin" from "Available Input Method" to "Current Input Method". </p>
</li>
</ol>
<p>Uncheck "Only Show Current Language" if "Pinyin" is not shown in "Available Input Method".</p>
<p>That's all. You will be able to use "Ctrl + Space" to use Chinese input method.</p> </div><!-- /.entry-content -->

                                <div class="medium primary btn"><a href="http://xiaojianfeng.github.io/code/install-chinese-input-method-on-t61-running-debian.html" rel="bookmark" title="Permalink to install Chinese input method on T61 running Debian">Read more <i class="icon-arrow-right"></i></a></div>



                                <div class="row tag-row">
                                </div>



                        </article></li>
                        <li><article class="hentry">
                                <header> <h2 class="entry-title"><a href="http://xiaojianfeng.github.io/bioinf/convert-bam-file-to-fastq.html" rel="bookmark" title="Permalink to convert bam file to fastq">convert bam file to fastq</a></h2> </header>
                                <footer class="post-info">
                                    <abbr class="published" title="2014-08-06T20:16:55+08:00"> Wed 06 August 2014 </abbr>
                                    <address class="vcard author">By 
                                    <a class="url fn" href="http://xiaojianfeng.github.io/author/xiao-jianfeng.html"> Xiao Jianfeng</a>
                                    </address>
                                </footer><!-- /.post-info -->
                                <div class="entry-content"> <p>After having struggled for a while to find a convenient tool to extract .fastq file to .bam file, I decided to write one.</p>
<p>The problems with current tools are:</p>
<ul>
<li>Couldn't deal with reads having multiple match in .bam file.</li>
<li>Some tools require the .bam to be sorted by name first.</li>
</ul>
<p>In my program (https://github.com/XiaoJianfeng/ibl/blob/master/util/bam2fq.sh), Sqlite3 is used to do the heavy job. Below is the details of how to do it:</p>
<ol>
<li>
<p>"samtools view" read .bam file and output to stdout.</p>
</li>
<li>
<p>Sqlite3 create a table fastq with 4 columns (qname, flag, seq, qual), and import data from stdout to the table with sqlite3 command ".import".
CREATE TABLE fastq (qname, flag, seq, qual);</p>
<p>select date()||" "||time()||" import begin";<br />
.separator "\t"<br />
.import temp.$$ fastq 
CREATE INDEX qname_idx on fastq (qname);   </p>
</li>
<li>
<p>Sqlite3 creat two tables, "left" and "right", and get qname of read_1 and read_2 to these two tables separately. whether a read is the first read or second read is identified by checking the flag. 0x40 is set for first read, while 0x80 is set for second read.</p>
<p>CREATE TABLE left as select qname from fastq where flag &amp; 64 == 64;<br />
CREATE TABLE right as select qname from fastq where flag &amp; 128 == 128;  </p>
</li>
<li>
<p>select reads from table "fastq" that are the first in the pair, and has corresponding mate pair in table "right"; and select reads from table "fastq" that are the second in the pair, and has corresponding mate pair in table "left". "\n" is used as separator between columns, and the output is redirected to .fastq file.</p>
<p>.output ${left_file}<br />
.separator "\n"<br />
select distinct "@"||right.qname||"/1", seq, '+', qual from right join fastq on fastq.qname == right.qname where flag&amp;64 == 64 order by right.qname;  </p>
<p>.output ${right_file}<br />
.separator "\n"<br />
select distinct "@"||left.qname||"/2", seq, '+', qual from left join fastq on fastq.qname == left.qname where flag&amp;128 == 128 order by left.qname;  </p>
</li>
<li>
<p>job done.</p>
</li>
</ol>
<p>With my program, the .bam file doesn't need to be sorted beforehand.</p>
<p>It has one limition: the output .fastq files are not compressed. I will remove this limition later when I have time. But please rest assured it works perfectly well at the moment.</p>
<h2>[update 2014-08-11 22:33:09]:</h2>
<h3>fixed a bug regarding identification of first and second read in a pair by flags</h3>
<p>the primary alignment should have flag &amp; 0x900 == 0, first read has flag &amp; 0x40 == 0x40, and second read has flag &amp; 0x80 == 0x80</p>
<p>so primary alignment of first read should be flag &amp; 0x940 (ie. 2368) == 0x40, and for second read flag &amp; 0x980 (ie. 2432) == 0x80</p>
<p>CREATE TABLE left as select qname from fastq where flag &amp; 2368 == 64; <br />
   CREATE TABLE right as select qname from fastq where flag &amp; 2432 == 128;       </p>
<h3>bam2fq.sh is updated to support gziped output.</h3>
<p>details of the implementation:</p>
<ul>
<li>
<p>first creat named pipe</p>
<p>mkfifo tmp_output</p>
</li>
<li>
<p>use gzip to compress the content read from named pipe, and put the process into background</p>
<p>gzip -c &lt; tmp_output &gt; output.fq.gz &amp;</p>
</li>
<li>
<p>in sqlite3, output to to ...</p></li></ul> </div><!-- /.entry-content -->

                                <div class="medium primary btn"><a href="http://xiaojianfeng.github.io/bioinf/convert-bam-file-to-fastq.html" rel="bookmark" title="Permalink to convert bam file to fastq">Read more <i class="icon-arrow-right"></i></a></div>



                                <div class="row tag-row">
                                </div>



                        </article></li>
                        <li><article class="hentry">
                                <header> <h2 class="entry-title"><a href="http://xiaojianfeng.github.io/code/create-blog-on-github-pages-with-pelican.html" rel="bookmark" title="Permalink to create blog on github pages with pelican">create blog on github pages with pelican</a></h2> </header>
                                <footer class="post-info">
                                    <abbr class="published" title="2014-08-05T23:40:15+08:00"> Tue 05 August 2014 </abbr>
                                    <address class="vcard author">By 
                                    <a class="url fn" href="http://xiaojianfeng.github.io/author/xiao-jianfeng.html"> Xiao Jianfeng</a>
                                    </address>
                                </footer><!-- /.post-info -->
                                <div class="entry-content"> <ol>
<li>
<p>install pelican, ghp-import, and of course git</p>
</li>
<li>
<p>create a github repo: xiaojianfeng.github.io, and choose to not initalize with a README.md.</p>
</li>
<li>
<p>create a directory "technotes", cd into this directory and run "pelican-quickstart"</p>
<p>$ mkdir technotes <br />
$ cd technotes <br />
$ pelican-quickstart <br />
Welcome to pelican-quickstart v3.5.0.</p>
<p>This script will help you create a new Pelican-based website.</p>
<p>Please answer the following questions so this script can generate the files
needed by Pelican.</p>
<blockquote>
<p>Where do you want to create your new web site? [.] 
What will be the title of this web site? Tech Notes
Who will be the author of this web site? Xiao Jianfeng
What will be the default language of this web site? [en] 
Do you want to specify a URL prefix? e.g., http://example.com   (Y/n) <br />
What is your URL prefix? (see above example; no trailing slash) http://xiaojianfeng.github.io
Do you want to enable article pagination? (Y/n) 
How many articles per page do you want? [10] 20
Do you want to generate a Fabfile/Makefile to automate generation and publishing? (Y/n) 
Do you want an auto-reload &amp; simpleHTTP script to assist with theme and site development? (Y/n) 
Do you want to upload your website using FTP? (y/N) 
Do you want to upload your website using SSH? (y/N) 
Do you want to upload your website using Dropbox? (y/N) 
Do you want to upload your website using S3? (y/N) 
Do you want to upload your website using Rackspace Cloud Files? (y/N) 
Do you want to upload your website using GitHub Pages? (y/N) y
Is this your personal page (username.github.io)? (y/N) y
Done. Your new project is available at /path/to/technotes</p>
</blockquote>
</li>
<li>
<p>initalize git repo in directory on local harddisk</p>
<p>$ cd technotes
$ git remote add origin https://github.com:XiaoJianfeng/xiaojianfeng.github.io.git   </p>
</li>
<li>
<p>start to write blog with markdown, and then run "make github"</p>
<p>$ vim content/first_post.md  # and write something <br />
$ make github   </p>
</li>
</ol> </div><!-- /.entry-content -->

                                <div class="medium primary btn"><a href="http://xiaojianfeng.github.io/code/create-blog-on-github-pages-with-pelican.html" rel="bookmark" title="Permalink to create blog on github pages with pelican">Read more <i class="icon-arrow-right"></i></a></div>



                                <div class="row tag-row">
                                </div>



                        </article></li>
                        <li><article class="hentry">
                                <header> <h2 class="entry-title"><a href="http://xiaojianfeng.github.io/general/first-post.html" rel="bookmark" title="Permalink to first post">first post</a></h2> </header>
                                <footer class="post-info">
                                    <abbr class="published" title="2014-08-05T22:23:19+08:00"> Tue 05 August 2014 </abbr>
                                    <address class="vcard author">By 
                                    <a class="url fn" href="http://xiaojianfeng.github.io/author/xiao-jianfeng.html"> Xiao Jianfeng</a>
                                    </address>
                                </footer><!-- /.post-info -->
                                <div class="entry-content"> <p>Aftering having tried several blog platforms, finally I switched to github.</p>
<p>This blog will be the host of my tech notes.</p> </div><!-- /.entry-content -->

                                <div class="medium primary btn"><a href="http://xiaojianfeng.github.io/general/first-post.html" rel="bookmark" title="Permalink to first post">Read more <i class="icon-arrow-right"></i></a></div>



                                <div class="row tag-row">
                                </div>



                        </article></li>
                </ol><!-- /#posts-list -->

        </div><!-- /.eleven.columns -->
        
<div class="three columns">

<h4>Pages</h4>

 <ul>
  </ul>

<h4>Categories</h4>
<ul>
		<li><a href="http://xiaojianfeng.github.io/category/bioinf.html">bioinf</a></li>
		<li><a href="http://xiaojianfeng.github.io/code/index.html">code</a></li>
		<li><a href="http://xiaojianfeng.github.io/category/general.html">general</a></li>
</ul>


<h4>Tags</h4>


<nav class="widget">
  <h4>Social</h4>
  <ul>
    <li><a href="https://github.com/xiaojianfeng">github</a></li>
    <li><a href="#">Another social link</a></li>
  </ul>
</nav>

</div> </div><!-- /.row -->

<p class="paginator">
    Page 1 / 1
</p>
</section><!-- /#content -->

       </div><!-- /.row -->
    </div><!-- /.container -->


       <div class="container.nopad bg">

    
        <footer id="credits" class="row">
          <div class="seven columns left-center">

                   <address id="about" class="vcard body">
                    Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                    which takes great advantage of <a href="http://python.org">Python</a>.
                    <br />
                    Based on the <a target="_blank" href="http://gumbyframework.com">Gumby Framework</a>
                    </address>
          </div>


          <div class="seven columns">
            <div class="row">
              <ul class="socbtns">





              </ul>
            </div>
          </div>
        </footer>

    </div>


  <script src="http://xiaojianfeng.github.io/theme/js/libs/jquery-1.9.1.min.js"></script>
  <script src="http://xiaojianfeng.github.io/theme/js/libs/gumby.min.js"></script>
  <script src="http://xiaojianfeng.github.io/theme/js/plugins.js"></script>
</body>
</html>